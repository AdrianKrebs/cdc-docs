(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{151:function(t,e,a){"use strict";a.r(e);var r=a(0),s=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"dsl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dsl","aria-hidden":"true"}},[t._v("#")]),t._v(" DSL")]),a("p",[t._v("Pact provides an easy to use DSL to write your customer expectations.")]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('new PactDslJsonArray()\n    .array()                            # open an array\n    .stringValue("a1")                  # choose the method that is valid for arrays\n    .stringValue("a2")                  # choose the method that is valid for arrays\n    .closeArray()                       # close the array\n    .array()                            # open an array\n    .numberValue(1)                     # choose the method that is valid for arrays\n    .numberValue(2)                     # choose the method that is valid for arrays\n    .closeArray()                       # close the array\n    .array()                            # open an array\n    .object()                           # now we work with an object\n    .stringValue("foo", "Foo")          # choose the method that is valid for objects\n    .closeObject()                      # close the object and we\'re back in the array\n    .closeArray()                       # close the array\n')])])]),a("p",[a("a",{attrs:{href:"https://git.panter.ch/panter/pan-103-consumer/blob/master/src/test/java/ch/panter/cdc/consumer/GoalConsumerPactTest.java"}},[t._v("Example Consumer Test")])]),a("h3",{attrs:{id:"headers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#headers","aria-hidden":"true"}},[t._v("#")]),t._v(" Headers")]),a("p",[t._v("The Pact DSL offers a convinient way to do a matching on request and response headers.")]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('.given("default")\n\t.uponReceiving("retrieving goal data")\n\t.path("/goals")\n\t.headers(requestHeaders)\n')])])]),a("h3",{attrs:{id:"authentication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authentication","aria-hidden":"true"}},[t._v("#")]),t._v(" Authentication")]),a("p",[t._v("Sometimes you may need to add things to the requests that can't be persisted in a pact file. Examples of these would be authentication tokens, which have a small life span.")]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('@TargetRequestFilter\npublic void exampleRequestFilter(HttpRequest request) {\n\trequest.addHeader("Authorization", "OAUTH hdsagasjhgdjashgdah...");\n}\n')])])]),a("h2",{attrs:{id:"pact-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pact-broker","aria-hidden":"true"}},[t._v("#")]),t._v(" Pact Broker")]),a("p",[t._v("How do could we share Pacts?\nSharing contracts by email works pretty well. But as soon as you have multiple services using pact, you need some kind of versioning for your pacts.\nThe soulution is called "),a("a",{attrs:{href:"https://github.com/pact-foundation/pact_broker"}},[t._v("Pact Broker")]),t._v(".")]),a("p",[t._v("A Pact Broker isn't just a file storage:")]),a("ul",[a("li",[t._v("The Broker provides Versioning, Tagging, Rest-API")]),a("li",[t._v("Dependency Graph")]),a("li",[t._v("Living documentation for free")]),a("li",[t._v("Build Pipeline integration")])]),a("p",[a("img",{attrs:{src:"broker.jpg",alt:"broker"}})]),a("p",[a("a",{attrs:{href:"https://pact-broker.cdc.panter.biz/"}},[t._v("Example Broker")])]),a("h3",{attrs:{id:"how-to-setup-a-pact-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-setup-a-pact-broker","aria-hidden":"true"}},[t._v("#")]),t._v(" How to setup a pact broker:")]),a("ul",[a("li",[a("code",[t._v("docker pull dius/pact-broker")])]),a("li",[t._v("Setup a postgres database")]),a("li",[t._v("Ready to go")])]),a("h3",{attrs:{id:"how-to-publish-pact-files-to-the-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-publish-pact-files-to-the-broker","aria-hidden":"true"}},[t._v("#")]),t._v(" How to publish pact files to the broker:")]),a("ul",[a("li",[t._v("Configure "),a("code",[t._v("brokerUrl")]),t._v(" and "),a("code",[t._v("pactDirectory")])]),a("li",[t._v("Run "),a("code",[t._v("mvn pact:publish")]),t._v(" to push your contracts to the broker")])]),a("h3",{attrs:{id:"how-to-pull-pact-files-from-the-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-pull-pact-files-from-the-broker","aria-hidden":"true"}},[t._v("#")]),t._v(" How to pull pact files from the broker:")]),a("ul",[a("li",[t._v("Run "),a("code",[t._v("mvn pact:verify")]),t._v(" to pull all the contracts and verify your provider against it")]),a("li",[t._v("Publish results of a provider verification with setting the following system property:\n"),a("code",[t._v("-Dpact.verifier.publishResults=true")])])]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("How to add new interactions without breaking everything")]),a("p",[t._v("In summary: keep the CI running against a stable version of the pact, while simultaneously providing a new version for the provider team so they can update their code and provider states.\nOnce both the stable and the new versions of the pact are green, the new version can be published as the stable version.")])]),a("h2",{attrs:{id:"pact-in-comparison-to-other-api-testing-documentation-frameworks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pact-in-comparison-to-other-api-testing-documentation-frameworks","aria-hidden":"true"}},[t._v("#")]),t._v(" Pact in comparison to other API testing/documentation frameworks")]),a("table",[a("thead",[a("tr",[a("th",[t._v("Feature")]),a("th",[t._v("Pact")]),a("th",[t._v("Restdocs")]),a("th",[t._v("Swagger")])])]),a("tbody",[a("tr",[a("td",[t._v("Live Documentation")]),a("td",[t._v("yes")]),a("td",[t._v("yes")]),a("td",[t._v("no")])]),a("tr",[a("td",[t._v("HATEOAS Support")]),a("td",[t._v("yes")]),a("td",[t._v("yes")]),a("td",[t._v("no")])]),a("tr",[a("td",[t._v("Integration/ Maintainance effort")]),a("td",[t._v("high")]),a("td",[t._v("high")]),a("td",[t._v("low")])]),a("tr",[a("td",[t._v("Contracts")]),a("td",[t._v("yes")]),a("td",[t._v("no")]),a("td",[t._v("no")])]),a("tr",[a("td",[t._v("Versioning")]),a("td",[t._v("yes")]),a("td",[t._v("partly")]),a("td",[t._v("partly")])]),a("tr",[a("td",[t._v("Universallity")]),a("td",[t._v("yes")]),a("td",[t._v("partly")]),a("td",[t._v("no")])])])]),a("p",[t._v("As this table shows, these tools solve different problems and can be used together.\nA Pact documents the integration between a particular consumer and provider very well. However, it doesn't provide general documentation for a provider, which Swagger and RESTDocs do very well.")]),a("h2",{attrs:{id:"experiences"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#experiences","aria-hidden":"true"}},[t._v("#")]),t._v(" Experiences")]),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Experiences")]),a("ul",[a("li",[t._v("Increases confidence when coding & deploying (CD)")]),a("li",[t._v("Collaborative API design")]),a("li",[t._v("Living API documentation")])])]),a("h2",{attrs:{id:"pitfalls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pitfalls","aria-hidden":"true"}},[t._v("#")]),t._v(" Pitfalls")]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Pitfalls")]),a("ul",[a("li",[t._v("Provider state setup for each interaction (Pre conditions, state  - even if it should be stateless)")]),a("li",[t._v("Getting used to DSL is hard")]),a("li",[t._v("Don't limit to happy path (Response code when user from UserService doesn't exist)")]),a("li",[t._v("Automation isn't trivial (Pipeline)")])])]),a("h2",{attrs:{id:"limitations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#limitations","aria-hidden":"true"}},[t._v("#")]),t._v(" Limitations")]),a("ul",[a("li",[t._v("Limited Media Type support (no XML)")]),a("li",[t._v("No Websocket support")])]),a("h2",{attrs:{id:"sources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sources","aria-hidden":"true"}},[t._v("#")]),t._v(" Sources")]),a("ul",[a("li",[a("a",[t._v("https://martinfowler.com/articles/consumerDrivenContracts.html")])]),a("li",[a("a",[t._v("https://docs.pact.io/")])]),a("li",[a("a",[t._v("https://github.com/DiUS/pact-jvm")])]),a("li",[a("a",[t._v("https://pierrevincent.github.io/2017/03/increasing-collaboration-and-confidence-with-consumer-driven-contracts-testing/")])])])])}],!1,null,null,null);e.default=s.exports}}]);